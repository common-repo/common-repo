{
  "plan_name": "CLI/UX Review",
  "description": "Improve CLI user experience to meet OSS best practices",
  "last_updated": "2026-01-02",
  "audit_summary": {
    "current_score": "5/10",
    "pass": ["5.1 Help via -h/--help (clap)", "5.5 Progress indicators (indicatif)", "5.7 Colors (console crate)"],
    "partial": ["5.2 Help text examples (needs review)", "5.3 Error messages (needs review)", "5.6 Progress auto-hidden (needs verification)", "5.8 NO_COLOR support (needs verification)", "5.10 Exit codes (needs audit)"],
    "fail": ["5.4 Error suggestions", "5.9 Shell completions"]
  },
  "tasks": [
    {
      "id": "add-shell-completions",
      "name": "Add shell completion generation",
      "status": "complete",
      "priority": 1,
      "blocked_by": null,
      "steps": [
        "Add clap_complete to dependencies",
        "Create completions subcommand",
        "Generate completions for bash, zsh, fish, powershell, elvish",
        "Document completion installation in docs/src/cli.md",
        "Add E2E tests for completions command"
      ],
      "acceptance_criteria": [
        "common-repo completions <shell> generates valid completions",
        "Completions work for all major shells",
        "Installation documented"
      ]
    },
    {
      "id": "improve-help-examples",
      "name": "Add examples to help text",
      "status": "deferred",
      "priority": 1,
      "blocked_by": null,
      "steps": [
        "Review each command's help text",
        "Add #[command(after_help = ...)] with examples",
        "Show common use cases in help",
        "Ensure examples are copy-pasteable"
      ],
      "acceptance_criteria": [
        "Each command shows usage examples",
        "Examples cover common use cases",
        "Examples are accurate and work"
      ],
      "deferred_reason": "Too prone to drift early in project lifecycle"
    },
    {
      "id": "add-error-suggestions",
      "name": "Add suggestions to error messages",
      "status": "pending",
      "priority": 2,
      "blocked_by": null,
      "steps": [
        "Review common error scenarios",
        "Add 'Did you mean?' suggestions for typos",
        "Add 'Try running...' suggestions for fixable errors",
        "Include documentation links in errors",
        "Test error messages with users"
      ],
      "acceptance_criteria": [
        "Errors include actionable suggestions",
        "Common mistakes have helpful hints",
        "Links to docs where appropriate"
      ]
    },
    {
      "id": "verify-tty-behavior",
      "name": "Verify TTY detection for colors and progress",
      "status": "complete",
      "priority": 2,
      "blocked_by": null,
      "steps": [
        "Audit current color/progress implementation (console crate, indicatif)",
        "Test NO_COLOR=1 environment variable disables colors",
        "Test TERM=dumb disables colors",
        "Test piping output (non-TTY) disables colors",
        "Test progress bars hidden when piping output (non-TTY)",
        "Verify indicatif ProgressBar respects TTY detection",
        "Add E2E tests for TTY behavior",
        "Consider --no-progress flag if needed",
        "Document TTY behavior in CLI reference"
      ],
      "acceptance_criteria": [
        "NO_COLOR=1 disables all color output",
        "TERM=dumb disables colors",
        "Non-TTY output has no ANSI escape codes",
        "Progress bars hidden when stdout is not a TTY",
        "Output is clean when piped (e.g., common-repo ls | cat)",
        "E2E tests verify TTY behavior"
      ],
      "context": {
        "color_crate": "console - provides style(), colors(), is_term() detection",
        "progress_crate": "indicatif - ProgressBar with draw_target",
        "no_color_spec": "https://no-color.org/ - NO_COLOR env var standard",
        "related_files": ["src/main.rs", "src/commands/*.rs"]
      }
    },
    {
      "id": "audit-exit-codes",
      "name": "Audit and standardize exit codes",
      "status": "pending",
      "priority": 2,
      "blocked_by": null,
      "steps": [
        "Document expected exit codes",
        "0 = success, 1 = error, 2 = usage error",
        "Review main.rs for exit code handling",
        "Add tests for exit codes",
        "Document exit codes in CLI reference"
      ],
      "acceptance_criteria": [
        "Exit codes follow standard conventions",
        "Exit codes documented",
        "Tests verify exit codes"
      ]
    },
        {
      "id": "add-verbose-quiet-flags",
      "name": "Add --verbose and --quiet global flags",
      "status": "pending",
      "priority": 3,
      "blocked_by": null,
      "steps": [
        "Add -v/--verbose flag (can be repeated for more verbosity)",
        "Add -q/--quiet flag for minimal output",
        "Integrate with logging/output levels",
        "Document flag behavior"
      ],
      "acceptance_criteria": [
        "--verbose increases output detail",
        "--quiet minimizes output",
        "Flags work consistently across commands"
      ]
    }
  ],
  "notes": [
    "Shell completions are highly requested UX feature",
    "Error suggestions greatly improve user experience",
    "Exit codes matter for scripting and CI integration"
  ]
}
