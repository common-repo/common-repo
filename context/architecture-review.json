{
  "plan_name": "Architecture Review",
  "description": "Improve code architecture to meet OSS best practices",
  "last_updated": "2025-12-03",
  "audit_summary": {
    "current_score": "6/10",
    "pass": ["4.4 Clear separation lib/binary", "4.5 Error handling (thiserror+anyhow)", "4.6 Rust API Guidelines naming"],
    "partial": ["4.1 Workspace layout (single crate, no workspace needed yet)", "4.3 Folder names match crate names", "4.7 Standard traits (needs audit)", "4.9 pub(crate) usage (needs audit)"],
    "fail": ["4.2 Workspace dependencies centralized", "4.8 Builder pattern", "4.10 cargo xtask"]
  },
  "tasks": [
    {
      "id": "audit-pub-visibility",
      "name": "Audit and restrict pub visibility",
      "status": "pending",
      "priority": 1,
      "blocked_by": null,
      "steps": [
        "Review all pub items in each module",
        "Identify items that should be pub(crate) instead of pub",
        "Change internal items to pub(crate)",
        "Ensure public API is intentional and documented"
      ],
      "acceptance_criteria": [
        "Internal items use pub(crate)",
        "Public API is minimal and intentional",
        "No accidental public exposure"
      ]
    },
    {
      "id": "audit-standard-traits",
      "name": "Audit and implement standard traits",
      "status": "pending",
      "priority": 1,
      "blocked_by": null,
      "steps": [
        "Review all public structs and enums",
        "Add Debug derive where missing",
        "Add Clone where appropriate",
        "Add PartialEq/Eq where meaningful",
        "Consider Display for user-facing types"
      ],
      "acceptance_criteria": [
        "All public types derive Debug",
        "Clone/PartialEq added where appropriate",
        "No missing obvious trait implementations"
      ]
    },
    {
      "id": "add-builder-pattern",
      "name": "Add builder pattern for complex types",
      "status": "pending",
      "priority": 2,
      "blocked_by": null,
      "steps": [
        "Identify types with many optional fields",
        "Implement Builder pattern for RepositoryConfig or similar",
        "Use typed-builder or manual implementation",
        "Add examples showing builder usage"
      ],
      "acceptance_criteria": [
        "Complex types have builder methods",
        "Builder usage documented with examples"
      ]
    },
    {
      "id": "add-cargo-xtask",
      "name": "Add cargo xtask for automation",
      "status": "pending",
      "priority": 3,
      "blocked_by": null,
      "steps": [
        "Create xtask directory with Cargo.toml",
        "Add workspace configuration to root Cargo.toml",
        "Move complex script logic to xtask (coverage, release prep)",
        "Add xtask commands: coverage, release-prep, etc.",
        "Document xtask usage in CONTRIBUTING.md"
      ],
      "acceptance_criteria": [
        "xtask crate exists in workspace",
        "At least 2 xtask commands implemented",
        "Scripts simplified using xtask"
      ]
    },
    {
      "id": "improve-error-types",
      "name": "Review and improve error types",
      "status": "pending",
      "priority": 2,
      "blocked_by": null,
      "steps": [
        "Review error.rs for completeness",
        "Ensure all error variants have meaningful messages",
        "Add context to errors where helpful",
        "Ensure errors are actionable for users"
      ],
      "acceptance_criteria": [
        "All error types documented",
        "Error messages are user-friendly",
        "Errors include context/suggestions"
      ]
    },
    {
      "id": "add-module-documentation",
      "name": "Add module-level documentation",
      "status": "pending",
      "priority": 2,
      "blocked_by": null,
      "steps": [
        "Add //! documentation to each module file",
        "Explain module purpose and contents",
        "Add examples for key modules",
        "Link to related modules"
      ],
      "acceptance_criteria": [
        "All modules have //! documentation",
        "Key modules have usage examples"
      ]
    }
  ],
  "notes": [
    "Current architecture is reasonable for single-crate project",
    "Workspace would be useful if splitting into multiple crates",
    "xtask is optional but improves developer experience"
  ]
}
